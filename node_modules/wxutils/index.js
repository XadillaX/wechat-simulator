/**
 * Created with JetBrains WebStorm.
 * User: XadillaX
 * Date: 13-10-11
 * Time: 下午8:43
 * wechat utils.
 */
var crypto = require("crypto");

exports.getTimestamp = function() {
    var time = Date.now();
    time /= 1000;
    return parseInt(time);
};

exports.rand = function(max) {
    return new Number(Math.random() * max).toFixed(0);
};

exports.createSignature = function(timestamp, nonce, token) {
    var strArr = [ token, timestamp, nonce ];
    strArr.sort();
    var signature = strArr[0] + strArr[1] + strArr[2];

    var sha1 = crypto.createHash("sha1");
    sha1.update(signature);
    signature = sha1.digest("hex");

    return signature;
};

exports.createEchostr = function() {
    var len = 16;
    var echostr = "";
    var conststr = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789/*-+=";
    var constlen = conststr.length;

    for(var i = 0; i < 16; i++) {
        echostr += conststr[this.rand(constlen - 1)];
    }

    return echostr;
}
